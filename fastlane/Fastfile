default_platform :ios

platform :ios do

    desc "Create signing certs and provisioning profiles if needed"
    lane :signing do
        cert(team_id: "79RY8264V4", development: true)
        sigh(team_id: "79RY8264V4", app_identifier: "me.syan.TorrentAdder", development: true)

        cert(team_id: "79RY8264V4")
        sigh(team_id: "79RY8264V4", app_identifier: "me.syan.TorrentAdder", adhoc: true)
    
        system "rm ../*.mobileprovision"
        system "rm ../*.cer"
        system "rm ../*.p12"
        system "rm ../*.certSigningRequest"
    end


    desc "Submit a new Beta Build using FTP"
    desc "This will also make sure the profile is up to date"
    lane :ota do
        gym(export_method: "adhoc")
        ftp(host: "ftp.stanislaschevallier.fr",
            username: 'stanislaw',
            upload: {
            src: 'build/TorrentAdder.ipa',
            dest: '/www/ota/'
        }
    )
  end
end
